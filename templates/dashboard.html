{% extends "base.html" %}

{% block title %}BikeMate{% endblock %} <!--Title-->

{% block content %} <!--Custom content goes inside these blocks-->

<div class="dashboard_message">
    {% if session.email %}
        <h1>Velkommen tilbage {{session.name}}</h1>
    {% endif %}
</div>

<div class="rewards_component"> <!--Later use db for this-->
    <h1>Dine belønninger</h1>
    <div class="rewards_content">
        {% if rewards %}
        <div class="reward">Belønning</div>
        {% else %}
        <p>{{ no_rewards_found }}</p>
        {% endif %}
    </div>
</div>
<section class="main_content">
    <div class="posts_component">
        <h1>Seneste opslag</h1>
        <div class="post_container" hx-get="/dashboard/posts">
            {% if user_posts %}
                {% for user_post in user_posts %}
                <div class="post">
                    <p>{{ session.name}}</p>
                    <p class="post_date">{{ user_post.created }}</p>
                    <p class="post_content">{{ user_post.content }}</p>
                    {% if user_post.image_path %}
                        <img src="/{{ user_post.image_path }}" alt="post image" class="post_image">
                    {% endif %}
                    <button class="delete_post_btn" hx-delete="/dashboard/{{ user_post.id }}" 
                        hx-target=".post"
                        hx-confirm="Er du sikker på at du vil slette opslaget?">
                    Slet opslag</button>
                </div>
                    <hr>
                {% endfor %}
            {% else %}
                <p class="no_posts_found">{{ no_posts_found }}</p>
            {% endif %}
        </div>
    </div>
    
<div class="challenges_component">
    <h1>Dine udfordringer</h1>
    <div class="challenge_container">
        {% if challenges %}
            {% for challenge in challenges %}
                <div class="challenge">
                    <h3>{{ challenge.name }}</h3>
                        <p>Oprettet: <i class="fa-solid fa-clock"></i> {{ challenge.created }}</p>
                        <p>Slutter {{ challenge.end_date }}</p>
                        <p>Emne: {{ challenge.topic }}</p>
                        <p>Deltagere: <i class="fa-solid fa-user-group"></i> {{ challenge.participants_count}}</p>
                </div>
            {% endfor %}
        {% else %}
            <p>{{ no_challenges_found }}</p>
        {% endif %}
    </div>
</div>

<div class="follows">
    {% if follows %}
        {% for user in follows %}
            <p>{{ user.name }}</p>
        {% endfor %}
    {% endif %}
</div>
</section>

{% endblock %}